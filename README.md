# AI Code Reviewer

A lightweight AI-based code reviewer for GitHub pull requests. Analyzes PR diffs using Google Gemini Pro and generates structured review comments.

## Features

- üîç Analyzes code diffs for bugs, security issues, performance problems, and code smells
- ü§ñ Powered by Google Gemini Pro (free trial)
- üìä Generates structured JSON reports
- üí¨ Optional: Post comments directly to GitHub PRs
- ‚ö° Fast and lightweight (no database, no UI)

## Prerequisites

- Node.js 18+ 
- GitHub Personal Access Token ([create one here](https://github.com/settings/tokens))
- Google Gemini Pro API Key ([get one here](https://makersuite.google.com/app/apikey))

## Installation

```bash
npm install
```

## Configuration

Copy `.env.example` to `.env` and fill in your credentials:

```bash
cp .env.example .env
```

Edit `.env`:
```
GITHUB_TOKEN=your_github_token_here
GEMINI_API_KEY=your_gemini_api_key_here
```

## Usage

### Basic Review (Console + JSON)

```bash
npm run review -- --repo owner/repo --pr 123
```

### With Environment Variables

```bash
npm run review -- --repo facebook/react --pr 28000
```

### Post Comments to GitHub

```bash
npm run review -- --repo owner/repo --pr 123 --post
```

### Using Command Line Tokens

```bash
npm run review -- --repo owner/repo --pr 123 --token ghp_xxx --gemini-key AIzaSyxxx
```

## Development

```bash
# Watch mode
npm run dev -- --repo owner/repo --pr 123

# Build
npm run build
```

## Output

The tool generates:

1. **Console Output**: Pretty-printed review results with severity indicators
2. **report.json**: Structured JSON file with all findings

Example JSON output:
```json
{
  "prNumber": 123,
  "prTitle": "Fix authentication bug",
  "totalIssues": 3,
  "issuesBySeverity": {
    "high": 1,
    "medium": 1,
    "low": 1
  },
  "comments": [
    {
      "file": "src/auth.ts",
      "line": 42,
      "severity": "high",
      "message": "Potential SQL injection vulnerability",
      "suggestion": "Use parameterized queries instead of string concatenation"
    }
  ]
}
```

## How It Works

1. **Fetches PR Data**: Uses GitHub API to get PR metadata and file diffs
2. **Processes Diffs**: Analyzes only changed hunks (not entire files)
3. **AI Analysis**: Sends diffs to Gemini Pro for review
4. **Generates Report**: Structures findings by severity and file
5. **Optional Posting**: Can post comments back to GitHub PR

## Performance

- Processes files in batches to avoid rate limits
- Skips autogenerated files (`.min.js`, `.lock`, etc.)
- Limits diff size to ~500 lines per file
- Typically completes in < 2 minutes for medium-sized PRs

## Limitations

- Free tier API limits apply
- Reviews only changed code (not full context)
- May miss some issues that require full file context
- GitHub API rate limits: 50 comments per PR review

## Troubleshooting

**Error: "GitHub token required"**
- Set `GITHUB_TOKEN` in `.env` or use `--token` flag

**Error: "Gemini API key required"**
- Set `GEMINI_API_KEY` in `.env` or use `--gemini-key` flag

**Error: "Not found"**
- Check that the repository and PR number are correct
- Ensure your GitHub token has access to the repository

## License

MIT



